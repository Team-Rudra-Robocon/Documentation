<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Chapter 10 - ROS2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ROS2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-10---ros2-serviceclient-and-server-architechture"><a class="header" href="#chapter-10---ros2-serviceclient-and-server-architechture">Chapter 10 - ROS2 Service(Client and Server architechture)</a></h1>
<p>services are used for a client and server interaction</p>
<p>say we have a weather service which is a server and provides you with weather info
when loc is provided and you the client trying to access the weather using an http
request ,</p>
<p>now what will happen is the client will send a request and the server accepts the
requestes and it must send back a prooper responce , therefore one client and one
server can communicate with each other easily but say we have multiple clients , then
the multiple client will send requests using the same http request , and then the
server will process the request and then send the responce to the client</p>
<p>eg. You have a node that controls led panel and that node should communicate to
outside node , say you need to send a msg to the led node to turn on a LED when
battery percentage is low , we can do so by creating a service setLED , then creating
a server inside the LED node , and creating a client that will be the battery percent
, when the battery percent is low , then the client will send a request/msg through
the service to the server , msg being turning which light on , this msg is then
processed and the ligh tis turned on. Then the server will send a responce to that
client to notify that the request has been successfully performed , ie send a flag.
The client is waiting syncronusly or asyncronusly for the responce , now say you have
a full battery , the battery node sends a request through the service to turn off the
leds , then the same request is processsed by the server and after processing a
responce or a flag is sent ensure the request has been processed.This is how the ros2
servies work ?</p>
<p>You can directly create a service using rcl library , and also it has a single server
with many nodes for a single service. The service will exist when a server is created.</p>
<h3 id="creating-a-server"><a class="header" href="#creating-a-server">Creating a server</a></h3>
<ol>
<li>A service is created inside the server node</li>
</ol>
<pre><code class="language-node.create_service(typeOfService  ">serviceName , callBackFunctionForService)
</code></pre>
<p>the above line of code creates a service
inside the server node , the callback function has the thing that you need to process
or the request is processed in the callback function that contains 2 parameters ,
request and responce where responce is returned and request is processed. in ading two
numbers example the request is the 2 numbers coming from clients and the responce is
the sum. therefore the callback function does the job of calculating the sum and
returning the appropriate responce.</p>
<h3 id="creating-a-client"><a class="header" href="#creating-a-client">Creating a client</a></h3>
<ol>
<li>without using oop this method is used directly inside the main function without
using oop to create a node ie directly creating the node inside the main function.</li>
</ol>
<pre><code> node.create_client(typeOfService , serviceName)
</code></pre>
<p>This takes in 2 parameters ,
also it needs to wait for sometime for the request to process we add future</p>
<pre><code> client.call_async(request) 
</code></pre>
<p>this function creates a future ie , waits for
request to process</p>
<p>then rather that using .spin() function always we use</p>
<pre><code>spin_until_future_complete(nodeName , future) 
</code></pre>
<p>to spin until the future is complete
or the request is processed we store the requested responce in a variable and then
print it .</p>
<ol start="2">
<li>with oop what we do using OOP is we create a class inheriting from node like done
previously , and then what we do is we create a function inside the node that sends
out requests to the clients , that function creates a client and then adds requests</li>
</ol>
<pre><code>self.create_client() 
</code></pre>
<p>this create the client this is then used to send requests
, an object of AddTwoInts.request() is created called as requests and then that stores
the data to be sent to the server ie the 2 numbers. therfore similar to the future
used in the not oop case we use future , but to see the responce a callback is
necessary therefore a callback function is attached to the future which will be called
as soon as the responce is sent. just like before the callback function does all the
processing , here printing the respone ie the sum.</p>
<p>the program without oop is easier and simpler to implement , but th eprogramm using
oop is standers usually used in a file or a project , it is much more complex but it
gives us.</p>
<h2 id="how-to-debug-services-using-cli--terminal"><a class="header" href="#how-to-debug-services-using-cli--terminal">How to debug Services using CLI / Terminal</a></h2>
<pre><code>ros2 service
</code></pre>
<p>this gets you all the commands needed for debugging services</p>
<pre><code> ros2 service list ros2 service call
</code></pre>
<p>this helps in listing all the services and
the call used to call the service using Terminal ig using the service on Terminal.
This can be used to debug the service</p>
<pre><code> ros2 service type
</code></pre>
<p>This gets you the type of service that is being
processed(The first parameter from the create service function)</p>
<p>rclpy also helps in creating a client and using client service</p>
<h2 id="remap-a-service-at-runtime"><a class="header" href="#remap-a-service-at-runtime">remap a service at runtime</a></h2>
<p>just like nodes and topic we cna remap the services as well , similarly by using
ros-args -r</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="chapter_9.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="chapter_11.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="chapter_9.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="chapter_11.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
